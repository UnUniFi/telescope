<div class="mx-auto max-w-screen-xl">
  <h2>Vault Detail</h2>
  <div class="w-full md:w-auto mb-8">
    <div class="card bg-base-100 shadow-xl w-full">
      <div class="card-body">
        <h2 class="card-title">
          Vault #{{ vault?.vault?.id }}
          <div class="badge badge-primary">#{{ vault?.vault?.id }}</div>
          <div class="badge badge-secondary">{{ symbol }}</div>
        </h2>
        <!-- <div class="stats">
          <div class="stat">
            <div class="stat-title">APY</div>
            <div class="stat-value text-secondary">12.34%</div>
            <div class="stat-desc"></div>
          </div>
          <div class="stat">
            <div class="stat-title">TVL</div>
            <div class="stat-value">$ 12.3</div>
            <div class="stat-desc"></div>
          </div>
          <div class="stat">
            <div class="stat-title">Deposited</div>
            <div class="stat-value text-primary">$ 123</div>
            <div class="stat-desc"></div>
          </div>
          <div class="stat">
            <div class="stat-title">Earnings</div>
            <div class="stat-value">$ 12.3</div>
            <div class="stat-desc"></div>
          </div>
        </div> -->
        <div class="overflow-x-auto">
          <table class="table w-full">
            <tbody>
              <tr>
                <th>Vault ID</th>
                <td>{{ vault?.vault?.id }}</td>
              </tr>
              <tr>
                <th>Vault Address</th>
                <td>{{ vault?.vault_address }}</td>
              </tr>
              <!-- <tr>
                <th>Vault Name</th>
                <td>{{ 'Coming soon' }}</td>
              </tr> -->
              <tr>
                <th>Owner</th>
                <td>{{ vault?.vault?.owner }}</td>
              </tr>
              <tr>
                <th>Owner's Deposit</th>
                <td>{{ vault?.vault?.owner_deposit | coin }}</td>
              </tr>
              <tr>
                <th>Withdraw Commission Rate</th>
                <td>{{ vault?.vault?.withdraw_commission_rate | percentage }}</td>
              </tr>
              <tr>
                <th>Withdraw Reserve Rate</th>
                <td>{{ vault?.vault?.withdraw_reserve_rate | percentage }}</td>
              </tr>
              <tr>
                <th>Total Bonded Amount</th>
                <td>{{ vault?.total_bonded_amount }}</td>
              </tr>
              <tr>
                <th>Total Unbonding Amount</th>
                <td>{{ vault?.total_unbonding_amount }}</td>
              </tr>
              <tr>
                <th>Total Withdrawal Amount</th>
                <td>{{ vault?.total_withdrawal_balance }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <h3 class="mt-4">Historical APY (Demo)</h3>
        <div class="flex w-full justify-center" #chartRef>
          <google-chart
            [title]="chartTitle"
            [type]="chartType"
            [data]="chartData"
            [columns]="chartColumnNames"
            [options]="chartOptions"
          >
          </google-chart>
        </div>
      </div>
    </div>
  </div>

  <div class="w-full md:w-auto mb-8">
    <div class="card bg-base-100 shadow-xl w-full">
      <div class="tabs tabs-boxed w-full">
        <a class="tab tab-lg w-1/2" [class.tab-active]="tab === 'mint'" (click)="tab = 'mint'"
          >Deposit</a
        >
        <a class="tab tab-lg w-1/2" [class.tab-active]="tab === 'burn'" (click)="tab = 'burn'"
          >Withdraw</a
        >
      </div>
      <div class="card-body" *ngIf="tab === 'mint'">
        <form #depositFormRef="ngForm" (submit)="onSubmitDeposit()">
          <div class="form-control">
            <label class="label">
              <span class="label-text">Enter amount</span>
            </label>
            <label class="input-group">
              <input
                #depositAmountRef
                #depositAmountNgModelRef="ngModel"
                required
                type="number"
                class="input input-bordered w-full"
                [class]="{
                  'input-error': depositAmountNgModelRef.errors && depositAmountNgModelRef.touched
                }"
                [min]="0"
                [max]="symbolBalancesMap?.[symbol || ''] || 0"
                pattern="^[0-9]*\.?[0-9]{0,6}$"
                [(ngModel)]="mintAmount"
                name="mintAmount"
                (input)="onDepositAmountChange()"
              />
              <span>{{ symbol }}</span>
            </label>
            <label class="label">
              <span class="label-text-alt">Available balance:</span>
              <span class="label-text-alt">
                {{ symbolBalancesMap?.[symbol || ''] || 0 }} {{ symbol }}
              </span>
            </label>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text">You will receive</span>
            </label>
            <label class="input-group">
              <input disabled class="input input-bordered w-full" value="Coming Soon" />
              <span class="whitespace-nowrap">YA-VAULT-{{ vault?.vault?.id }}</span>
            </label>
          </div>

          <div class="card-actions justify-end mt-8">
            <button class="btn btn-primary px-8" [disabled]="depositFormRef.invalid">
              Deposit
            </button>
          </div>
        </form>
      </div>
      <div class="card-body" *ngIf="tab === 'burn'">
        <form #withdrawFormRef="ngForm" (submit)="onSubmitWithdraw()">
          <div class="form-control">
            <label class="label">
              <span class="label-text">Enter amount</span>
            </label>
            <label class="input-group">
              <input
                #withdrawAmountRef
                #withdrawAmountNgModelRef="ngModel"
                required
                type="number"
                class="input input-bordered w-full"
                [class]="{
                  'input-error': withdrawAmountNgModelRef.errors && withdrawAmountNgModelRef.touched
                }"
                [min]="0"
                [max]="symbolBalancesMap?.['YA-VAULT-'+ vault?.vault?.id || ''] || 0"
                pattern="^[0-9]*\.?[0-9]{0,6}$"
                [(ngModel)]="burnAmount"
                name="burnAmount"
                (input)="onWithdrawAmountChange()"
              />
              <span class="whitespace-nowrap">YA-VAULT-{{ vault?.vault?.id }}</span>
            </label>
            <label class="label">
              <span class="label-text-alt">Available balance:</span>
              <span class="label-text-alt"
                >{{ symbolBalancesMap?.['YA-VAULT-'+ vault?.vault?.id] || 0 }}
                {{ 'YA-VAULT-' + vault?.vault?.id }}
              </span>
            </label>
          </div>
          <div class="form-control">
            <label class="label">
              <span class="label-text">You will receive</span>
            </label>
            <label class="input-group">
              <input disabled class="input input-bordered w-full" value="Coming Soon" />
              <span>{{ symbol }}</span>
            </label>
          </div>

          <div class="card-actions justify-end mt-8">
            <button class="btn btn-secondary px-8" [disabled]="withdrawFormRef.invalid">
              Withdraw
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <h2>Strategies this vault contains</h2>
  <div class="flex flex-row flex-wrap -mr-12 -mb-12">
    <div
      *ngFor="let strategy of vault?.vault?.strategy_weights; let i = index"
      class="pr-12 pb-12 w-full md:w-1/2 xl:w-1/3"
    >
      <div class="card bg-base-100 shadow-xl w-full">
        <div class="card-body">
          <div class="flex flex-row">
            <div class="badge badge-lg badge-primary mr-1">{{ strategy.strategy_id }}</div>
          </div>
          <h2 class="card-title break-all">{{ getStrategyInfo(strategy.strategy_id)?.name }}</h2>
          <div class="stats">
            <div class="stat">
              <div class="stat-title">Allocation weight</div>
              <div class="stat-value">{{ strategy.weight | percentage }}</div>
              <div class="stat-desc"></div>
            </div>
          </div>

          <button
            routerLink="/yield-aggregator/strategies/{{ vault?.vault?.denom }}/{{
              strategy.strategy_id
            }}"
            class="btn btn-outline btn-info"
          >
            View
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
