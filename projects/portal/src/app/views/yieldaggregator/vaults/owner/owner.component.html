<div class="mx-auto max-w-screen-xl">
  <div class="text-xl breadcrumbs">
    <ul>
      <li routerLink="../.."><a>Vaults</a></li>
      <li>{{ owner }}</li>
    </ul>
  </div>

  <h2 class="breal-all mt-4">Created Vaults</h2>
  <ng-container *ngFor="let vault of vaults">
    <div class="w-full md:w-auto mb-8">
      <div class="card bg-base-100 shadow-xl w-full">
        <div class="card-body">
          <h2 class="card-title">
            <ng-container *ngIf="symbolImage">
              <div class="avatar">
                <div class="mask mask-circle w-6 h-6">
                  <img src="{{ symbolImage }}" alt="Asset Symbol" />
                </div>
              </div>
            </ng-container>
            <ng-container *ngIf="!symbolImage">
              <span class="material-symbols-outlined">question_mark</span>
            </ng-container>
            <span *ngIf="vault?.vault?.name">{{ vault?.vault?.name }}</span>
            <span *ngIf="!vault?.vault?.name">Vault #{{ vault?.vault?.id }}</span>
          </h2>
          <div class="overflow-x-auto">
            <table class="table w-full">
              <tbody>
                <tr>
                  <th>Vault ID</th>
                  <td>{{ vault?.vault?.id }}</td>
                </tr>
                <tr>
                  <th>Vault Name</th>
                  <td>{{ vault.vault?.name }}</td>
                </tr>
                <tr>
                  <th>Owner's Deposit</th>
                  <td>{{ vault?.vault?.owner_deposit | coin | async }}</td>
                </tr>
                <tr>
                  <th>Withdraw Commission Rate</th>
                  <td>{{ vault?.vault?.withdraw_commission_rate | percent : '1.0-4' }}</td>
                </tr>
                <tr>
                  <th>Withdraw Reserve Rate</th>
                  <td>{{ vault?.vault?.withdraw_reserve_rate | percent : '1.0-4' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <h3>Strategies</h3>
          <div class="overflow-x-auto">
            <table class="table w-full">
              <thead>
                <tr>
                  <th></th>
                  <th>Strategy Name</th>
                  <th>Percentage</th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let strategy of vault.vault?.strategy_weights">
                  <tr
                    class="hover cursor-pointer"
                    routerLink="/yield-aggregator/strategies/{{ vault.vault?.denom }}/{{
                      strategy.strategy_id
                    }}"
                    [routerLink]="[
                      '/yield-aggregator/strategies',
                      vault.vault?.denom,
                      strategy.strategy_id
                    ]"
                  >
                    <th>#{{ strategy.strategy_id }}</th>
                    <td>{{ getStrategyDetail(strategy.strategy_id)?.strategy?.name }}</td>
                    <td>{{ strategy.weight | percent : '1.0-2' }}</td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>

          <div class="card-actions justify-end" *ngIf="owner === address">
            <label
              for="transfer-modal-{{ vault.vault?.id }}"
              class="btn btn-outline btn-secondary mr-2"
              >Transfer</label
            >
          </div>
          <!-- Put this part before </body> tag -->
          <input type="checkbox" id="transfer-modal-{{ vault.vault?.id }}" class="modal-toggle" />
          <div class="modal modal-bottom sm:modal-middle">
            <div class="modal-box">
              <h3 class="font-bold text-lg">
                Are you sure to transfer the ownership of this Vault?
              </h3>
              <form #transferFormRef="ngForm" (submit)="onSubmitTransfer(vault.vault?.id)">
                <div class="form-control">
                  <label class="label">
                    <span class="label-text">Enter Destination address</span>
                  </label>
                  <input
                    type="text"
                    required
                    #recipientNgModelRef="ngModel"
                    placeholder="Enter the recipient address (prefix: ununifi)"
                    class="input input-bordered w-full"
                    [class]="{
                      'input-error': recipientNgModelRef.errors && recipientNgModelRef.touched
                    }"
                    [(ngModel)]="recipientAddress"
                    name="recipient"
                  />
                </div>

                <p class="py-4">
                  The ownership of the vault #{{ vault.vault?.id }} will be transferred to the
                  address, do you proceed?
                </p>
                <div class="modal-action">
                  <label for="transfer-modal-{{ vault.vault?.id }}" class="btn btn-outline"
                    >Cancel</label
                  >
                  <button class="btn btn-secondary" [disabled]="transferFormRef.invalid">
                    Transfer
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
  <p *ngIf="!vaults?.length" class="mt-4 ml-4">There is no vault.</p>
</div>
